<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>European License Plate Hunt</title>
<meta name="description" content="Check off each European license plate as you spot it. Zoom, pan, and tap on countries. Progress saved in cookies." />
<style>
  :root{
    --bg:#0b1020;
    --panel:#11172e;
    --ink:#e8ecff;
    --ink-dim:#a8b1d8;
    --accent:#5dd3ff;
    --accent-2:#7affc7;
    --tile:#1a2346;
    --tile-hover:#243062;
    --tile-seen:#2b9159;
    --tile-outline:#3b4775;
    --blue:#0A4B9C; /* EU band (placed on RIGHT per your spec) */
  }
  html,body{height:100%}
  body{
    margin:0;
    background: radial-gradient(1200px 800px at 60% 20%, #0e1630 0%, #0b1020 40%, #080d1a 100%) fixed;
    color:var(--ink);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  header{
    position:sticky; top:0; z-index:20;
    display:flex; gap:.8rem; align-items:center; justify-content:space-between;
    padding:.75rem 1rem;
    background:linear-gradient(180deg, rgba(8,13,26,.9), rgba(8,13,26,.6) 60%, rgba(8,13,26,0));
    backdrop-filter:saturate(1.2) blur(6px);
    border-bottom:1px solid rgba(255,255,255,.06);
  }
  header h1{font-size:1rem; margin:.1rem 0; letter-spacing:.3px; color:var(--ink)}
  .sub{color:var(--ink-dim); font-size:.82rem}
  .bar{
    display:flex; gap:.5rem; align-items:center; flex-wrap:wrap;
  }
  .pill{
    border:1px solid rgba(255,255,255,.12);
    background:var(--panel);
    color:var(--ink);
    border-radius:999px;
    padding:.4rem .7rem;
    font-size:.85rem;
    display:inline-flex; gap:.45rem; align-items:center;
  }
  .btn{
    cursor:pointer;
    border:1px solid rgba(255,255,255,.14);
    background:linear-gradient(180deg,#1a2241,#151d39);
    color:var(--ink);
    border-radius:10px;
    padding:.5rem .8rem;
    font-weight:600; letter-spacing:.2px;
    transition:transform .05s ease, background .2s ease;
    display:inline-flex; gap:.5rem; align-items:center;
  }
  .btn:active{ transform: translateY(1px) scale(.99); }
  .btn.secondary{ background:linear-gradient(180deg,#10203a,#0e1a2f)}
  .hint{font-size:.8rem;color:var(--ink-dim)}
  main{
    position:fixed; inset:56px 0 0; /* below header */
    display:grid;
    grid-template-columns: 1fr 340px;
    gap:0;
  }
  @media (max-width: 980px){
    main{ grid-template-columns: 1fr }
    aside{ position:fixed; right:.75rem; bottom:.75rem; width:auto; max-width:min(92vw,480px)}
  }
  #viewport{
    position:relative; overflow:hidden; touch-action:none; background:
      radial-gradient(1200px 800px at 60% 35%, rgba(56,123,255,.06) 0%, rgba(56,123,255,0) 55%),
      linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0));
  }
  svg#map{
    width:100%; height:100%; display:block; background:transparent;
  }
  /* Tiles (cartogram squares) */
  .country{
    fill:var(--tile);
    stroke:var(--tile-outline); stroke-width:1.2;
    rx:10; ry:10;
    transition: fill .15s ease, stroke .15s ease, transform .05s ease;
  }
  .hit{ cursor:pointer }
  .group:hover .country{ fill:var(--tile-hover) }
  .group.seen .country{ fill:var(--tile-seen); stroke:#204b34 }
  .label{
    font-size:10.5px; font-weight:700; pointer-events:none;
    fill:#e9efff; text-anchor:middle; dominant-baseline:middle;
  }
  /* Mini plate SVG in each tile */
  .plate{ pointer-events:none }
  /* Sidebar / legend */
  aside{
    z-index:15;
    margin:.75rem;
    border:1px solid rgba(255,255,255,.12);
    background:linear-gradient(180deg,#101833,#0c142b);
    border-radius:14px;
    padding: .8rem;
    display:flex; flex-direction:column; gap:.7rem;
    box-shadow: 0 10px 40px rgba(0,0,0,.35);
  }
  .progress{
    height:8px;border-radius:999px;
    background:rgba(255,255,255,.08); overflow:hidden;
    outline:1px solid rgba(255,255,255,.08)
  }
  .progress > i{
    display:block; height:100%; width:0%;
    background:linear-gradient(90deg, var(--accent), var(--accent-2));
    transition:width .4s ease;
  }
  .legend{
    display:flex; flex-wrap:wrap; gap:.4rem .5rem; align-items:center;
    font-size:.85rem; color:var(--ink-dim)
  }
  .swatch{ width:1.2rem; height:.8rem; border-radius:3px; border:1px solid rgba(255,255,255,.2); display:inline-block; vertical-align:middle; margin-right:.35rem}
  .swatch.yellow{ background:#f3e167}
  .swatch.white{ background:#f9f9f9}
  .list{
    max-height:40vh; overflow:auto; border-top:1px solid rgba(255,255,255,.08); padding-top:.5rem;
  }
  .row{
    display:grid; grid-template-columns: 1.2rem 1fr auto; gap:.6rem; align-items:center;
    padding:.35rem .2rem; border-radius:8px;
  }
  .row:hover{ background:rgba(255,255,255,.04) }
  .row .tick{
    width:1.1rem; height:1.1rem; border-radius:3px; border:1px solid rgba(255,255,255,.25);
    background:rgba(255,255,255,.06); display:inline-grid; place-items:center; font-size:.85rem;
  }
  .row.seen .tick{ background:#2b9159; border-color:#204b34 }
  .row small{ color:var(--ink-dim) }
  .ghost{ opacity:.5 }
  footer{
    position:fixed; left:0; right:0; bottom:0; z-index:10;
    padding:.4rem .8rem; text-align:center; color:var(--ink-dim); font-size:.8rem;
    background:linear-gradient(0deg, rgba(8,13,26,.85), rgba(8,13,26,0));
  }
</style>
</head>
<body>
<header>
  <div>
    <h1>European License Plate Hunt</h1>
    <div class="sub">Tap a country to toggle “seen”. Pinch to zoom, drag to pan. Progress saves to cookies.</div>
  </div>
  <div class="bar">
    <span class="pill" id="countPill">Seen: 0 / 37</span>
    <button class="btn" id="resetBtn" title="Clear all progress">Reset</button>
  </div>
</header>

<main>
  <section id="viewport" aria-label="Zoomable map">
    <!-- Zoomable, pannable SVG tile map (cartogram) -->
    <svg id="map" viewBox="0 0 1200 800" role="img" aria-labelledby="title desc">
      <title id="title">Tile map of Europe for license plate spotting</title>
      <desc id="desc">Square tiles positioned roughly according to geography; each tile shows a mini license plate and country code.</desc>
      <defs>
        <!-- Mini plate symbol: background body + right EU band with code -->
        <!-- We color the body (white/yellow) via style on <use> wrapper -->
        <g id="plateSymbol" class="plate">
          <rect x="-38" y="-10" width="76" height="20" rx="2.5" ry="2.5" fill="#f9f9f9" stroke="#cfd4e3" stroke-width="1"/>
          <rect x="28" y="-10" width="14" height="20" rx="2" ry="2" fill="var(--blue)"/>
          <text x="35" y="0" fill="#fff" font-family="ui-sans-serif, system-ui, Segoe UI, Roboto, Arial" font-weight="800" font-size="10" text-anchor="middle" dominant-baseline="central" class="euCode">EU</text>
        </g>
      </defs>

      <!-- Group wrapper we transform for zoom/pan -->
      <g id="world">
        <!-- Helper: seas/land backdrop for vibe -->
        <rect x="-2000" y="-2000" width="5000" height="5000" fill="transparent"/>

        <!-- Country tiles (approximate positions). Each group carries data-* and toggles .seen -->
        <!-- Use 64x48 rounded rects for good tap targets -->
        <!-- Format: group[data-id][data-name][data-code][data-bg="white|yellow"] -->
        <!-- WEST / NORTHWEST -->
        <!-- Ireland -->
        <g class="group" transform="translate(140,280)" data-id="IRL" data-name="Ireland" data-code="IRL" data-bg="white">
          <rect class="country hit" x="-32" y="-24" width="64" height="48" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="26">IRL</text>
        </g>
        <!-- United Kingdom -->
        <g class="group" transform="translate(220,260)" data-id="UK" data-name="United Kingdom" data-code="UK" data-bg="yellow">
          <rect class="country hit" x="-32" y="-24" width="64" height="48" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="26">UK</text>
        </g>
        <!-- Iceland -->
        <g class="group" transform="translate(80,120)" data-id="IS" data-name="Iceland" data-code="IS" data-bg="white">
          <rect class="country hit" x="-32" y="-24" width="64" height="48" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="26">IS</text>
        </g>
        <!-- Portugal -->
        <g class="group" transform="translate(210,520)" data-id="P" data-name="Portugal" data-code="P" data-bg="white">
          <rect class="country hit" x="-32" y="-24" width="64" height="48" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="26">P</text>
        </g>
        <!-- Spain -->
        <g class="group" transform="translate(290,520)" data-id="E" data-name="Spain" data-code="E" data-bg="white">
          <rect class="country hit" x="-36" y="-26" width="72" height="52" rx="12" ry="12"/>
          <use href="#plateSymbol" x="0" y="-2"></use>
          <text class="label" x="0" y="28">E</text>
        </g>
        <!-- France -->
        <g class="group" transform="translate(360,460)" data-id="F" data-name="France" data-code="F" data-bg="white">
          <rect class="country hit" x="-40" y="-28" width="80" height="56" rx="12" ry="12"/>
          <use href="#plateSymbol" x="0" y="-2"></use>
          <text class="label" x="0" y="30">F</text>
        </g>
        <!-- Belgium -->
        <g class="group" transform="translate(420,380)" data-id="B" data-name="Belgium" data-code="B" data-bg="white">
          <rect class="country hit" x="-26" y="-20" width="52" height="40" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="22">B</text>
        </g>
        <!-- Netherlands -->
        <g class="group" transform="translate(430,340)" data-id="NL" data-name="Netherlands" data-code="NL" data-bg="yellow">
          <rect class="country hit" x="-28" y="-20" width="56" height="40" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="22">NL</text>
        </g>
        <!-- Luxembourg -->
        <g class="group" transform="translate(450,420)" data-id="L" data-name="Luxembourg" data-code="L" data-bg="yellow">
          <rect class="country hit" x="-22" y="-16" width="44" height="32" rx="8" ry="8"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="18">L</text>
        </g>
        <!-- Germany -->
        <g class="group" transform="translate(500,380)" data-id="D" data-name="Germany" data-code="D" data-bg="white">
          <rect class="country hit" x="-44" y="-32" width="88" height="64" rx="12" ry="12"/>
          <use href="#plateSymbol" x="0" y="-3"></use>
          <text class="label" x="0" y="34">D</text>
        </g>
        <!-- Denmark -->
        <g class="group" transform="translate(520,290)" data-id="DK" data-name="Denmark" data-code="DK" data-bg="white">
          <rect class="country hit" x="-26" y="-20" width="52" height="40" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="1"></use>
          <text class="label" x="0" y="22">DK</text>
        </g>
        <!-- Norway -->
        <g class="group" transform="translate(510,200)" data-id="N" data-name="Norway" data-code="N" data-bg="white">
          <rect class="country hit" x="-26" y="-20" width="52" height="40" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="1"></use>
          <text class="label" x="0" y="22">N</text>
        </g>
        <!-- Sweden -->
        <g class="group" transform="translate(560,230)" data-id="S" data-name="Sweden" data-code="S" data-bg="white">
          <rect class="country hit" x="-30" y="-22" width="60" height="44" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="24">S</text>
        </g>
        <!-- Finland -->
        <g class="group" transform="translate(640,210)" data-id="FIN" data-name="Finland" data-code="FIN" data-bg="white">
          <rect class="country hit" x="-30" y="-22" width="60" height="44" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="24">FIN</text>
        </g>
        <!-- Estonia -->
        <g class="group" transform="translate(660,270)" data-id="EST" data-name="Estonia" data-code="EST" data-bg="white">
          <rect class="country hit" x="-26" y="-18" width="52" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="20">EST</text>
        </g>
        <!-- Latvia -->
        <g class="group" transform="translate(650,310)" data-id="LV" data-name="Latvia" data-code="LV" data-bg="white">
          <rect class="country hit" x="-26" y="-18" width="52" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="20">LV</text>
        </g>
        <!-- Lithuania -->
        <g class="group" transform="translate(630,350)" data-id="LT" data-name="Lithuania" data-code="LT" data-bg="white">
          <rect class="country hit" x="-26" y="-18" width="52" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="20">LT</text>
        </g>
        <!-- Poland -->
        <g class="group" transform="translate(600,400)" data-id="PL" data-name="Poland" data-code="PL" data-bg="white">
          <rect class="country hit" x="-40" y="-28" width="80" height="56" rx="12" ry="12"/>
          <use href="#plateSymbol" x="0" y="-2"></use>
          <text class="label" x="0" y="30">PL</text>
        </g>
        <!-- Czechia -->
        <g class="group" transform="translate(560,420)" data-id="CZ" data-name="Czechia" data-code="CZ" data-bg="white">
          <rect class="country hit" x="-26" y="-18" width="52" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="20">CZ</text>
        </g>
        <!-- Slovakia -->
        <g class="group" transform="translate(590,450)" data-id="SK" data-name="Slovakia" data-code="SK" data-bg="white">
          <rect class="country hit" x="-26" y="-18" width="52" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="20">SK</text>
        </g>
        <!-- Austria -->
        <g class="group" transform="translate(540,460)" data-id="A" data-name="Austria" data-code="A" data-bg="white">
          <rect class="country hit" x="-28" y="-18" width="56" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="20">A</text>
        </g>
        <!-- Switzerland -->
        <g class="group" transform="translate(500,480)" data-id="CH" data-name="Switzerland" data-code="CH" data-bg="white">
          <rect class="country hit" x="-24" y="-16" width="48" height="32" rx="8" ry="8"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="18">CH</text>
        </g>
        <!-- Italy -->
        <g class="group" transform="translate(560,520)" data-id="I" data-name="Italy" data-code="I" data-bg="white">
          <rect class="country hit" x="-36" y="-26" width="72" height="52" rx="12" ry="12"/>
          <use href="#plateSymbol" x="0" y="-2"></use>
          <text class="label" x="0" y="28">I</text>
        </g>
        <!-- Slovenia -->
        <g class="group" transform="translate(570,495)" data-id="SLO" data-name="Slovenia" data-code="SLO" data-bg="white">
          <rect class="country hit" x="-23" y="-16" width="46" height="32" rx="8" ry="8"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="18">SLO</text>
        </g>
        <!-- Croatia -->
        <g class="group" transform="translate(580,520)" data-id="HR" data-name="Croatia" data-code="HR" data-bg="white">
          <rect class="country hit" x="-23" y="-16" width="46" height="32" rx="8" ry="8"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="18">HR</text>
        </g>
        <!-- Bosnia & Herzegovina -->
        <g class="group" transform="translate(605,540)" data-id="BIH" data-name="Bosnia &amp; Herzegovina" data-code="BIH" data-bg="white">
          <rect class="country hit" x="-25" y="-16" width="50" height="32" rx="8" ry="8"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="18">BIH</text>
        </g>
        <!-- Serbia -->
        <g class="group" transform="translate(635,540)" data-id="SRB" data-name="Serbia" data-code="SRB" data-bg="white">
          <rect class="country hit" x="-25" y="-16" width="50" height="32" rx="8" ry="8"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="18">SRB</text>
        </g>
        <!-- Montenegro -->
        <g class="group" transform="translate(615,565)" data-id="MNE" data-name="Montenegro" data-code="MNE" data-bg="white">
          <rect class="country hit" x="-22" y="-14" width="44" height="28" rx="7" ry="7"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="16">MNE</text>
        </g>
        <!-- North Macedonia -->
        <g class="group" transform="translate(650,565)" data-id="NMK" data-name="North Macedonia" data-code="NMK" data-bg="white">
          <rect class="country hit" x="-24" y="-14" width="48" height="28" rx="7" ry="7"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="16">NMK</text>
        </g>
        <!-- Albania -->
        <g class="group" transform="translate(620,590)" data-id="AL" data-name="Albania" data-code="AL" data-bg="white">
          <rect class="country hit" x="-22" y="-14" width="44" height="28" rx="7" ry="7"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="16">AL</text>
        </g>
        <!-- Greece -->
        <g class="group" transform="translate(680,600)" data-id="GR" data-name="Greece" data-code="GR" data-bg="white">
          <rect class="country hit" x="-34" y="-22" width="68" height="44" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="24">GR</text>
        </g>
        <!-- Hungary -->
        <g class="group" transform="translate(610,480)" data-id="H" data-name="Hungary" data-code="H" data-bg="white">
          <rect class="country hit" x="-28" y="-18" width="56" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="20">H</text>
        </g>
        <!-- Romania -->
        <g class="group" transform="translate(680,480)" data-id="RO" data-name="Romania" data-code="RO" data-bg="white">
          <rect class="country hit" x="-34" y="-22" width="68" height="44" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="24">RO</text>
        </g>
        <!-- Bulgaria -->
        <g class="group" transform="translate(700,520)" data-id="BG" data-name="Bulgaria" data-code="BG" data-bg="white">
          <rect class="country hit" x="-30" y="-18" width="60" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="20">BG</text>
        </g>
        <!-- Cyprus -->
        <g class="group" transform="translate(770,610)" data-id="CY" data-name="Cyprus" data-code="CY" data-bg="white">
          <rect class="country hit" x="-22" y="-14" width="44" height="28" rx="7" ry="7"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="16">CY</text>
        </g>
        <!-- Malta -->
        <g class="group" transform="translate(610,620)" data-id="M" data-name="Malta" data-code="M" data-bg="white">
          <rect class="country hit" x="-20" y="-12" width="40" height="24" rx="6" ry="6"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="14">M</text>
        </g>
        <!-- Andorra -->
        <g class="group" transform="translate(330,500)" data-id="AND" data-name="Andorra" data-code="AND" data-bg="white">
          <rect class="country hit" x="-18" y="-12" width="36" height="24" rx="6" ry="6"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="14">AND</text>
        </g>
        <!-- Monaco -->
        <g class="group" transform="translate(400,510)" data-id="MC" data-name="Monaco" data-code="MC" data-bg="white">
          <rect class="country hit" x="-18" y="-12" width="36" height="24" rx="6" ry="6"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="14">MC</text>
        </g>
        <!-- San Marino -->
        <g class="group" transform="translate(590,505)" data-id="RSM" data-name="San Marino" data-code="RSM" data-bg="white">
          <rect class="country hit" x="-18" y="-12" width="36" height="24" rx="6" ry="6"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="14">RSM</text>
        </g>
        <!-- Liechtenstein -->
        <g class="group" transform="translate(520,465)" data-id="FL" data-name="Liechtenstein" data-code="FL" data-bg="white">
          <rect class="country hit" x="-16" y="-12" width="32" height="24" rx="6" ry="6"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="14">FL</text>
        </g>
        <!-- Vatican City -->
        <g class="group" transform="translate(545,535)" data-id="V" data-name="Vatican City" data-code="V" data-bg="white">
          <rect class="country hit" x="-16" y="-12" width="32" height="24" rx="6" ry="6"/>
          <use href="#plateSymbol" x="0" y="0"></use>
          <text class="label" x="0" y="14">V</text>
        </g>
        <!-- Belarus -->
        <g class="group" transform="translate(680,380)" data-id="BY" data-name="Belarus" data-code="BY" data-bg="white">
          <rect class="country hit" x="-34" y="-22" width="68" height="44" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="24">BY</text>
        </g>
        <!-- Ukraine -->
        <g class="group" transform="translate(750,420)" data-id="UA" data-name="Ukraine" data-code="UA" data-bg="white">
          <rect class="country hit" x="-44" y="-28" width="88" height="56" rx="12" ry="12"/>
          <use href="#plateSymbol" x="0" y="-2"></use>
          <text class="label" x="0" y="30">UA</text>
        </g>
        <!-- Moldova -->
        <g class="group" transform="translate(740,480)" data-id="MD" data-name="Moldova" data-code="MD" data-bg="white">
          <rect class="country hit" x="-26" y="-18" width="52" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="20">MD</text>
        </g>
        <!-- Turkey (European part) -->
        <g class="group" transform="translate(820,570)" data-id="TR" data-name="Turkey" data-code="TR" data-bg="white">
          <rect class="country hit" x="-46" y="-22" width="92" height="44" rx="10" ry="10"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="24">TR</text>
        </g>
        <!-- Georgia -->
        <g class="group" transform="translate(900,520)" data-id="GEO" data-name="Georgia" data-code="GE" data-bg="white">
          <rect class="country hit" x="-26" y="-18" width="52" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="20">GE</text>
        </g>
        <!-- Armenia -->
        <g class="group" transform="translate(940,520)" data-id="AM" data-name="Armenia" data-code="AM" data-bg="white">
          <rect class="country hit" x="-26" y="-18" width="52" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="20">AM</text>
        </g>
        <!-- Azerbaijan -->
        <g class="group" transform="translate(970,500)" data-id="AZ" data-name="Azerbaijan" data-code="AZ" data-bg="white">
          <rect class="country hit" x="-26" y="-18" width="52" height="36" rx="9" ry="9"/>
          <use href="#plateSymbol" x="0" y="-1"></use>
          <text class="label" x="0" y="20">AZ</text>
        </g>
      </g>
    </svg>
  </section>

  <aside>
    <div class="pill" id="progressPill">0% complete</div>
    <div class="progress" aria-hidden="true"><i id="bar"></i></div>
    <div class="legend">
      <span><span class="swatch white"></span>White plate</span>
      <span><span class="swatch yellow"></span>Yellow plate</span>
      <span class="hint">Blue EU box is shown on the <b>right</b> per your spec.</span>
    </div>
    <div class="pill secondary hint">Tip: You can also toggle from this list</div>
    <div class="list" id="countryList" aria-label="All countries"></div>
  </aside>
</main>

<footer>
  Made with ❤️ — no external libraries. Your progress is stored in a cookie on this device.
</footer>

<script>
/* --------------------------
   Data + helpers
--------------------------- */
// Keep a single source of truth: every <g.group> in the SVG is a country node.
// We'll build a structured dataset from the DOM at startup.
const svg = document.getElementById('map');
const world = document.getElementById('world');
const groups = Array.from(world.querySelectorAll('g.group'));

// Determine plate body color and code per node; paint the plate accordingly
function paintPlate(g){
  const code = g.dataset.code || '';
  const bg = (g.dataset.bg || 'white').toLowerCase();
  // Update the mini plate: change background fill on first child rect of symbol (<use> is shadow DOM; we wrap styling on <use> via CSS variables)
  // Since we used a <use> that references a symbol with fixed colors, we can overlay a rect:
  let overlay = g.querySelector('rect.plateBody');
  if(!overlay){
    overlay = document.createElementNS('http://www.w3.org/2000/svg','rect');
    overlay.setAttribute('class','plateBody');
    overlay.setAttribute('x', -38);
    overlay.setAttribute('y', -10);
    overlay.setAttribute('width', 76);
    overlay.setAttribute('height', 20);
    overlay.setAttribute('rx', 2.5);
    overlay.setAttribute('ry', 2.5);
    overlay.setAttribute('stroke', '#cfd4e3');
    overlay.setAttribute('stroke-width', '1');
    // Insert overlay before use's next sibling text to stay above base
    const use = g.querySelector('use');
    g.insertBefore(overlay, use.nextSibling);
  }
  overlay.setAttribute('fill', bg === 'yellow' ? '#f3e167' : '#f9f9f9');

  // Update EU letters on right band
  const euText = g.querySelector('text.euCode');
  // The euCode is inside the symbol, not directly available; create a free text cloned to sit on band:
  let bandText = g.querySelector('text.bandCode');
  if(!bandText){
    bandText = document.createElementNS('http://www.w3.org/2000/svg','text');
    bandText.setAttribute('class','bandCode');
    bandText.setAttribute('x', 35);
    bandText.setAttribute('y', 0);
    bandText.setAttribute('fill', '#fff');
    bandText.setAttribute('font-family', 'ui-sans-serif, system-ui, Segoe UI, Roboto, Arial');
    bandText.setAttribute('font-weight', '800');
    bandText.setAttribute('font-size', '10');
    bandText.setAttribute('text-anchor', 'middle');
    bandText.setAttribute('dominant-baseline', 'central');
    const use = g.querySelector('use');
    g.insertBefore(bandText, use.nextSibling.nextSibling); // after overlay
  }
  bandText.textContent = code;

  // Also set the tile label (bottom text) for clarity
  const label = g.querySelector('.label');
  if(label) label.textContent = code;
}

// Build a flat list for the sidebar
const allCountries = groups.map(g => ({
  id: g.dataset.id,
  code: g.dataset.code,
  name: g.dataset.name,
  bg: (g.dataset.bg || 'white').toLowerCase(),
  node: g
}));

// Paint all plates initially
groups.forEach(paintPlate);

// Compute totals
const TOTAL = allCountries.length;

// Cookie helpers
const COOKIE_NAME = 'eu-plates-progress';
function setCookie(name, value, days){
  const expires = (() => {
    const d = new Date();
    d.setTime(d.getTime() + (days*24*60*60*1000));
    return "expires="+ d.toUTCString();
  })();
  document.cookie = name + "=" + encodeURIComponent(value) + ";" + expires + ";path=/;SameSite=Lax";
}
function getCookie(name){
  const n = name + "=";
  const ca = document.cookie.split(';');
  for(let c of ca){
    c = c.trim();
    if(c.indexOf(n) === 0) return decodeURIComponent(c.substring(n.length));
  }
  return "";
}

// State: a Set of seen IDs
let seen = new Set();
function loadProgress(){
  const raw = getCookie(COOKIE_NAME);
  if(!raw) return;
  try{
    const arr = JSON.parse(raw);
    if(Array.isArray(arr)) arr.forEach(id => seen.add(id));
  }catch(e){ /* ignore */ }
}
function saveProgress(){
  const arr = Array.from(seen);
  setCookie(COOKIE_NAME, JSON.stringify(arr), 3650); // ~10 years
}

// Apply state to DOM
function updateDOM(){
  // Toggle .seen class on groups
  groups.forEach(g => {
    const id = g.dataset.id;
    if(seen.has(id)){ g.classList.add('seen'); }
    else{ g.classList.remove('seen'); }
  });
  // Sidebar list checkmarks
  document.querySelectorAll('.row').forEach(row => {
    const id = row.dataset.id;
    row.classList.toggle('seen', seen.has(id));
    const tick = row.querySelector('.tick');
    tick.textContent = seen.has(id) ? '✓' : '';
  });
  // Progress bar + pill
  const count = seen.size;
  const pct = Math.round((count / TOTAL) * 100);
  document.getElementById('bar').style.width = pct + '%';
  document.getElementById('progressPill').textContent = pct + '% complete';
  document.getElementById('countPill').textContent = `Seen: ${count} / ${TOTAL}`;
}

// Toggle handler
function toggleCountry(id){
  if(seen.has(id)) seen.delete(id); else seen.add(id);
  saveProgress();
  updateDOM();
}

// Click handlers on tiles
groups.forEach(g => {
  g.addEventListener('click', (e) => {
    // Only toggle on direct taps, avoid accidental drags: we’ll have a tiny debounce using a threshold captured by the pan logic.
    toggleCountry(g.dataset.id);
  });
});

// Build the sidebar list
const listEl = document.getElementById('countryList');
function renderList(){
  // Sort alphabetically by name
  const sorted = [...allCountries].sort((a,b)=> a.name.localeCompare(b.name));
  listEl.innerHTML = '';
  for(const c of sorted){
    const row = document.createElement('div');
    row.className = 'row';
    row.dataset.id = c.id;
    row.innerHTML = `
      <span class="tick" aria-hidden="true"></span>
      <div>
        <div>${c.name} <small class="ghost">(${c.code})</small></div>
        <small>${c.bg === 'yellow' ? 'Yellow plate' : 'White plate'}</small>
      </div>
      <div>
        <!-- tiny SVG plate preview -->
        <svg width="80" height="22" viewBox="-40 -11 80 22" class="plate">
          <rect x="-38" y="-10" width="76" height="20" rx="2.5" ry="2.5" fill="${c.bg === 'yellow' ? '#f3e167' : '#f9f9f9'}" stroke="#cfd4e3" stroke-width="1"></rect>
          <rect x="28" y="-10" width="14" height="20" rx="2" ry="2" fill="var(--blue)"></rect>
          <text x="35" y="0" fill="#fff" font-weight="800" font-size="10" text-anchor="middle" dominant-baseline="central">${c.code}</text>
        </svg>
      </div>
    `;
    row.addEventListener('click', ()=> toggleCountry(c.id));
    listEl.appendChild(row);
  }
}

// Reset button
document.getElementById('resetBtn').addEventListener('click', ()=>{
  if(confirm('Reset your progress for all countries on this device?')){
    seen.clear();
    saveProgress();
    updateDOM();
  }
});

// Load + render
loadProgress();
renderList();
updateDOM();

/* --------------------------
   Zoom & Pan (mouse + touch)
--------------------------- */
(function(){
  const viewport = document.getElementById('viewport');
  let viewBox = { x: 0, y: 0, w: 1200, h: 800 };
  let isPanning = false;
  let last = { x: 0, y: 0 };
  let touchMode = false;

  function applyViewBox(){
    svg.setAttribute('viewBox', `${viewBox.x} ${viewBox.y} ${viewBox.w} ${viewBox.h}`);
  }
  applyViewBox();

  function clientToSvgPoint(clientX, clientY){
    const pt = svg.createSVGPoint();
    pt.x = clientX; pt.y = clientY;
    const ctm = svg.getScreenCTM().inverse();
    return pt.matrixTransform(ctm);
  }

  // Mouse wheel zoom
  viewport.addEventListener('wheel', (e)=>{
    e.preventDefault();
    const scale = (e.deltaY > 0) ? 1.1 : (1/1.1);
    const mouse = clientToSvgPoint(e.clientX, e.clientY);
    // Zoom around mouse
    viewBox.x = mouse.x - (mouse.x - viewBox.x) * scale;
    viewBox.y = mouse.y - (mouse.y - viewBox.y) * scale;
    viewBox.w *= scale;
    viewBox.h *= scale;
    // Clamp zoom
    const minW = 300, minH = 200, maxW = 2400, maxH = 1600;
    viewBox.w = Math.min(Math.max(viewBox.w, minW), maxW);
    viewBox.h = Math.min(Math.max(viewBox.h, minH), maxH);
    applyViewBox();
  }, { passive:false });

  // Mouse drag pan
  viewport.addEventListener('pointerdown', (e)=>{
    viewport.setPointerCapture(e.pointerId);
    isPanning = true;
    last = clientToSvgPoint(e.clientX, e.clientY);
  });
  viewport.addEventListener('pointermove', (e)=>{
    if(!isPanning || touchMode) return;
    const p = clientToSvgPoint(e.clientX, e.clientY);
    const dx = p.x - last.x, dy = p.y - last.y;
    viewBox.x -= dx; viewBox.y -= dy;
    last = p;
    applyViewBox();
  });
  const endPan = (e)=>{ isPanning = false; viewport.releasePointerCapture?.(e.pointerId); };
  viewport.addEventListener('pointerup', endPan);
  viewport.addEventListener('pointercancel', endPan);
  viewport.addEventListener('pointerleave', endPan);

  // Touch pinch + pan
  let touches = new Map();
  viewport.addEventListener('touchstart', (e)=>{
    touchMode = true;
    for(const t of e.changedTouches) touches.set(t.identifier, { x:t.clientX, y:t.clientY });
  }, {passive:true});
  viewport.addEventListener('touchmove', (e)=>{
    if(e.touches.length === 1){
      // 1-finger pan
      const t = e.touches[0];
      const prev = touches.get(t.identifier) || {x:t.clientX, y:t.clientY};
      const p1 = clientToSvgPoint(prev.x, prev.y);
      const p2 = clientToSvgPoint(t.clientX, t.clientY);
      viewBox.x -= (p2.x - p1.x);
      viewBox.y -= (p2.y - p1.y);
      applyViewBox();
      touches.set(t.identifier, {x:t.clientX, y:t.clientY});
    } else if(e.touches.length >= 2){
      const [t1, t2] = [e.touches[0], e.touches[1]];
      const prev1 = touches.get(t1.identifier) || {x:t1.clientX, y:t1.clientY};
      const prev2 = touches.get(t2.identifier) || {x:t2.clientX, y:t2.clientY};
      const distPrev = Math.hypot(prev2.x - prev1.x, prev2.y - prev1.y);
      const distNow  = Math.hypot(t2.clientX - t1.clientX, t2.clientY - t1.clientY);
      if(distPrev > 0){
        const scale = distPrev / distNow;
        const midX = (t1.clientX + t2.clientX)/2;
        const midY = (t1.clientY + t2.clientY)/2;
        const mid = clientToSvgPoint(midX, midY);
        viewBox.x = mid.x - (mid.x - viewBox.x) * scale;
        viewBox.y = mid.y - (mid.y - viewBox.y) * scale;
        viewBox.w *= scale;
        viewBox.h *= scale;
        const minW = 300, minH = 200, maxW = 2400, maxH = 1600;
        viewBox.w = Math.min(Math.max(viewBox.w, minW), maxW);
        viewBox.h = Math.min(Math.max(viewBox.h, minH), maxH);
        applyViewBox();
      }
      touches.set(t1.identifier, {x:t1.clientX, y:t1.clientY});
      touches.set(t2.identifier, {x:t2.clientX, y:t2.clientY});
    }
  }, {passive:false});
  viewport.addEventListener('touchend', (e)=>{
    for(const t of e.changedTouches) touches.delete(t.identifier);
    if(e.touches.length === 0) setTimeout(()=> touchMode=false, 50);
  }, {passive:true});
  viewport.addEventListener('touchcancel', (e)=>{
    for(const t of e.changedTouches) touches.delete(t.identifier);
    if(e.touches.length === 0) setTimeout(()=> touchMode=false, 50);
  }, {passive:true});
})();
</script>
</body>
</html>
